<header class="w-full h-full xl:h-10 flex justify-between items-center px-2 relative">
	<div class="w-fit flex justify-start items-center gap-2">
		@if (isManageTriadsPage()) {
			<button
				(click)="navigateToHome()"
				class="w-fit h-5 md:h-7 xl:h-8 flex justify-center items-center px-2 md:px-4 xl:px-6 shadow-sm triad-gradient text-xs md:text-base xl:text-lg text-primary-content font-semibold rounded-2xl hover:opacity-80 transition-opacity cursor-pointer">
				Back to home
			</button>
		}
		@if (isGameplayPage()) {
			<button
				(click)="quitGame()"
				[matTooltip]="'Quit'"
				class="w-5 h-5 md:w-7 md:h-7 xl:w-8 xl:h-8 flex justify-center items-center rounded-full shadow-sm triad-gradient hover:opacity-80 transition-opacity cursor-pointer"
				aria-label="Quit game">
				<svg class="w-3 h-3 md:w-4 md:h-4 xl:w-5 xl:h-5 text-primary-content" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
				</svg>
			</button>
		}
	</div>

	<div class="absolute top-5 md:top-7 xl:top-8 z-20" [class.hidden]="!showStats()" [class.block]="showStats()">
		<app-stats (whenClosingStatsWindow)="closeStatsWindow()" />
	</div>

	@if (showQuitConfirmation()) {
		<app-quit-confirmation-dialog (whenConfirmed)="confirmQuit()" (whenCanceled)="cancelQuit()" />
	}

	@if (showNewIdentityDialog()) {
		<app-new-identity-dialog (whenClosingDialog)="closeNewIdentityDialog()" />
	}

	@if (showAdminPasswordDialog()) {
		<app-admin-password-dialog (whenAuthenticated)="onAdminAuthenticated()" (whenCanceled)="closeAdminPasswordDialog()" />
	}

	<div class="w-fit flex justify-end items-center gap-4">
		<div class="relative" appClickOutside (appClickOutside)="closeUsernameDropdown()">
			<button
				(click)="toggleUsernameDropdown($event)"
				class="w-fit h-5 md:h-7 xl:h-8 flex justify-center items-center px-2 md:px-4 xl:px-6 rounded-full shadow-sm triad-gradient cursor-pointer">
				<p class="text-xs md:text-base xl:text-lg text-primary-content font-semibold">{{ store.user()?.username ?? '-' }}</p>
			</button>
			@if (showUsernameDropdown()) {
				<div
					class="absolute top-full right-0 mt-2 w-48 landscape:max-md:w-40 md:w-48 bg-base-100 rounded-lg shadow-lg border border-base-300 p-1.5 landscape:max-md:p-1.5 md:p-2 z-50 flex flex-col gap-0.5 landscape:max-md:gap-0.5 md:gap-1">
					<button
						type="button"
						(click)="openStats()"
						class="w-full text-left px-3 landscape:max-md:px-3 md:px-4 py-1.5 landscape:max-md:py-1.5 md:py-2 text-xs landscape:max-md:text-xs md:text-sm text-base-content hover:bg-base-200 rounded-md transition-colors cursor-pointer">
						Check your stats
					</button>
					<button
						type="button"
						(click)="openNewIdentity()"
						class="w-full text-left px-3 landscape:max-md:px-3 md:px-4 py-1.5 landscape:max-md:py-1.5 md:py-2 text-xs landscape:max-md:text-xs md:text-sm text-base-content hover:bg-base-200 rounded-md transition-colors cursor-pointer">
						New identity
					</button>
					<div class="px-3 landscape:max-md:px-3 md:px-4 py-1.5 landscape:max-md:py-1.5 md:py-2">
						<label
							for="difficulty-dropdown"
							class="block text-[10px] landscape:max-md:text-[10px] md:text-xs text-base-content/70 mb-0.5 landscape:max-md:mb-0.5 md:mb-1"
							>Select Difficulty</label
						>
						<select
							id="difficulty-dropdown"
							[ngModel]="selectedDifficulty()"
							(ngModelChange)="onDifficultyChange($event)"
							class="w-full px-2 landscape:max-md:px-2 md:px-3 py-1.5 landscape:max-md:py-1.5 md:py-2 text-xs landscape:max-md:text-xs md:text-sm text-base-content bg-base-200 border border-base-300 rounded-md hover:bg-base-300 focus:outline-none focus:ring-2 focus:ring-primary cursor-pointer">
							<option [value]="Difficulty.EASY">Soft</option>
							<option [value]="Difficulty.MEDIUM">Firm</option>
							<option [value]="Difficulty.HARD">Hard</option>
							<option [value]="Difficulty.RANDOM">Mixed (complete)</option>
						</select>
					</div>
					@if (showAdminOption()) {
						@if (isAdminAuthenticated()) {
							<button
								type="button"
								(click)="navigateToManageTriads()"
								class="w-full text-left px-3 landscape:max-md:px-3 md:px-4 py-1.5 landscape:max-md:py-1.5 md:py-2 text-xs landscape:max-md:text-xs md:text-sm text-base-content hover:bg-base-200 rounded-md transition-colors cursor-pointer">
								Manage Triads
							</button>
						} @else {
							<button
								type="button"
								(click)="openAdminPasswordDialog()"
								class="w-full text-left px-3 landscape:max-md:px-3 md:px-4 py-1.5 landscape:max-md:py-1.5 md:py-2 text-xs landscape:max-md:text-xs md:text-sm text-base-content hover:bg-base-200 rounded-md transition-colors cursor-pointer">
								Admin
							</button>
						}
					}
				</div>
			}
		</div>
		<button
			(click)="showHowToPlay()"
			class="w-fit h-5 md:h-7 xl:h-8 flex justify-center items-center px-2 md:px-4 xl:px-6 rounded-full shadow-sm triad-gradient cursor-pointer">
			<p class="text-xs md:text-base xl:text-lg text-primary-content font-semibold">?</p>
		</button>
	</div>
</header>
