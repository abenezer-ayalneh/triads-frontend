<div class="w-full h-full flex flex-col">
	<!-- Header Section - Sticky -->
	<div class="shrink-0 sticky top-0 z-10 p-4 md:p-6 lg:p-8">
		<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
			<h1 class="text-2xl md:text-3xl lg:text-4xl font-bold text-gray-800">Manage Triads</h1>
			<div class="flex flex-col sm:flex-row gap-3 items-stretch sm:items-center">
				<!-- Search Input -->
				<div class="relative flex-1 sm:flex-initial">
					<input
						type="text"
						(input)="onSearchInput($event)"
						[value]="searchQuery()"
						placeholder="Search by keyword..."
						class="w-full px-4 py-2 pr-10 border border-gray-300 bg-base-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-base" />
					@if (searchQuery()) {
						<button type="button" (click)="onClearSearch()" class="absolute right-2 top-1/2 -translate-y-1/2 p-1 text-gray-500 hover:text-gray-700">
							<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="18" y1="6" x2="6" y2="18"></line>
								<line x1="6" y1="6" x2="18" y2="18"></line>
							</svg>
						</button>
					}
				</div>
				<!-- Add Button -->
				<button
					type="button"
					(click)="onAdd()"
					class="px-4 md:px-6 py-2 bg-linear-to-r triad-gradient text-white rounded-lg hover:opacity-90 transition-opacity font-medium shadow-md">
					Add Triad Group
				</button>
			</div>
		</div>
	</div>

	<!-- Triad Groups List - Scrollable -->
	<div #scrollContainer class="flex-1 overflow-y-auto p-4 md:p-6 lg:p-8 mt-6" (scroll)="onScroll()">
		<div class="w-full h-52 grid grid-cols-1 lg:grid-cols-2 gap-2">
			@if (triadGroups().length === 0 && !isLoading()) {
				<div class="col-span-full text-center py-12 text-gray-500">
					<p class="text-lg text-black">No triad groups found</p>
					@if (searchQuery()) {
						<p class="text-sm text-black mt-2">Try a different search term</p>
					} @else {
						<p class="text-sm text-black mt-2">Click "Add Triad Group" to create one</p>
					}
				</div>
			} @else {
				@for (group of triadGroups(); track group.id) {
					<app-triad-group-card
						[triadGroup]="group"
						(editClicked)="onEdit($event)"
						(deleteClicked)="onDelete($event)"
						(toggleStatusClicked)="onToggleStatus($event.id, $event.active)" />
				}
			}

			<!-- Loading Indicator -->
			@if (isLoading()) {
				<div class="col-span-full flex justify-center items-center py-8">
					<span class="loading loading-spinner loading-lg"></span>
				</div>
			}
		</div>
	</div>

	<!-- Add Dialog -->
	<ion-modal [isOpen]="showAddDialog()" (didDismiss)="onAddDialogCanceled()">
		<ng-template>
			<app-add-triad-group-dialog (whenCreated)="onAddDialogCreated($event)" (whenCanceled)="onAddDialogCanceled()" />
		</ng-template>
	</ion-modal>

	<!-- Edit Dialog -->
	<ion-modal [isOpen]="Boolean(showEditDialog() && selectedTriadGroup() !== null)" (didDismiss)="onEditDialogCanceled()">
		<ng-template>
			<app-edit-triad-group-dialog [triadGroup]="selectedTriadGroup()!" (whenSaved)="onEditDialogSaved($event)" (whenCanceled)="onEditDialogCanceled()" />
		</ng-template>
	</ion-modal>

	<!-- Delete Confirmation Dialog -->
	<ion-modal [isOpen]="showDeleteConfirm()" (didDismiss)="onDeleteCanceled()">
		<ng-template>
			<app-delete-confirmation-dialog (whenConfirmed)="onDeleteConfirmed()" (whenCanceled)="onDeleteCanceled()" />
		</ng-template>
	</ion-modal>
</div>
